<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="Hexo, NexT" />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="主攻前端方向，偶尔来点杂文">
<meta property="og:type" content="website">
<meta property="og:title" content="青菜不是葵花">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="青菜不是葵花">
<meta property="og:description" content="主攻前端方向，偶尔来点杂文">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="青菜不是葵花">
<meta name="twitter:description" content="主攻前端方向，偶尔来点杂文">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title> 青菜不是葵花 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container sidebar-position-left 
   page-home 
 ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">青菜不是葵花</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">绽放吧！</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/16/http-status3xx/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/16/http-status3xx/" itemprop="url">
                  301 302 303 307
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-16T09:25:32Z">
                2017-11-16
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="HTTP-1-0"><a href="#HTTP-1-0" class="headerlink" title="HTTP 1.0"></a>HTTP 1.0</h1><h3 id="301-moved-permanently"><a href="#301-moved-permanently" class="headerlink" title="301 moved permanently"></a>301 moved permanently</h3><p>规范：301表示永久重定向，当资源被永久迁移到一个新的URL时，任何未来对该资源的访问都会重定向到这个新的URL。具有编辑能力的用户将自动重新链接到新的地址上。新的链接地址需在服务器的响应首部给出，除了HEAD请求，这个响应报文的实体需要包含一个新的超链接的说明。但如果是对于POST方法的请求，若返回301状态码，用户则需要确认后才能重定向。</p>
<p>实现：但实际上关于post请求重定向用户确认的问题，浏览器上并没有实现，而且部分浏览器还会还会错误的发送一个GET请求到新地址。</p>
<h3 id="302-moved-temporarily"><a href="#302-moved-temporarily" class="headerlink" title="302 moved temporarily"></a>302 moved temporarily</h3><p>HTTP1.0：302表示临时重定向，location中的地址不应该被认为是资源路径，在后续的请求中应该继续使用原地址。原请求是post，则不能自动进行重定向，原请求是get,可以自动重定向。</p>
<p>实现：浏览器即便请求POST也会自动重定向。</p>
<p>应用：302劫持——若A站通过重定向到B站的资源x，A站具有较好的域名，但B站域名不那么友好，因此对搜索引擎而言，可能会保存A站的地址对应资源x而不是B站，这样A站就利用了B站的资源提高了自己的搜索排名。</p>
<p>总结：301与302规范和实现上一样，不同的是301是永久重定向，302是临时重定向。</p>
<h1 id="HTTP-1-1"><a href="#HTTP-1-1" class="headerlink" title="HTTP 1.1"></a>HTTP 1.1</h1><h3 id="301-moved-permanently-1"><a href="#301-moved-permanently-1" class="headerlink" title="301 moved permanently"></a>301 moved permanently</h3><p>同1.0</p>
<h3 id="302-found"><a href="#302-found" class="headerlink" title="302 found"></a>302 found</h3><p>302不再推荐使用，为兼容而保留。且再次重申只有当请求是GET或HEAD时才能自动重定向。为了消除HTTP1.0中302的二义性，在HTTP1.0中引入了303和307来细化302的语义。</p>
<h3 id="303-see-other"><a href="#303-see-other" class="headerlink" title="303 see other"></a>303 see other</h3><p>HTTP1.1: 1.0中302的实现</p>
<h3 id="307-temporary-redirect"><a href="#307-temporary-redirect" class="headerlink" title="307 temporary redirect"></a>307 temporary redirect</h3><p>HHTP1.1：1.0中302的规范</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/06/interview-jrtt/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/06/interview-jrtt/" itemprop="url">
                  面试笔记1
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-06T14:45:27Z">
                2017-11-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="1-margin和padding"><a href="#1-margin和padding" class="headerlink" title="1. margin和padding"></a>1. margin和padding</h3><p>margin：块级元素都有效，行内元素只有左右有效。行内元素还会忽略周围元素上下的margin值而直接进行布局。</p>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>auto</td>
<td>浏览器设置的上外边距。</td>
</tr>
<tr>
<td>length</td>
<td>定义固定的上外边距。默认值是 0。</td>
</tr>
<tr>
<td>%</td>
<td>定义基于父对象宽度的百分比。</td>
</tr>
<tr>
<td>inherit</td>
<td>规定应该从父元素继承上外边距。默认继承性：no</td>
</tr>
</tbody>
</table>
<p>padding: 块级元素都有效，行内元素只有左右有效。行内元素不能忽略父级元素的上下padding值。</p>
<table>
<thead>
<tr>
<th>值</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>auto</td>
<td>浏览器计算内边距。</td>
</tr>
<tr>
<td>length</td>
<td>规定以具体单位计的内边距值，比如像素、厘米等。默认值是 0。</td>
</tr>
<tr>
<td>%</td>
<td>规定基于父元素的宽度的百分比。</td>
</tr>
<tr>
<td>inherit</td>
<td>规定应该从父元素继承内边距。默认继承性：no</td>
</tr>
</tbody>
</table>
<h3 id="2-如何html中开启和关闭DNS预读取？"><a href="#2-如何html中开启和关闭DNS预读取？" class="headerlink" title="2. 如何html中开启和关闭DNS预读取？"></a>2. 如何html中开启和关闭DNS预读取？</h3><p>参考网页：<a href="https://developer.mozilla.org/zh-CN/docs/Controlling_DNS_prefetching" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Controlling_DNS_prefetching</a><br>通过X-DNS-Prefetch-Control: on/off来设置。</p>
<p>X-DNS-Prefetch-Control的功能是:<br>X-DNS-Prefetch-Control控制着浏览器的预读取功能，它可以使得浏览器主动去执行域名解析的功能，包括文档中所有的链接。预读取会在后台执行，所以DNS很可能在链接对应的东西出现之前就已经解析完毕。这样能够减少用户点击链接时的延迟。</p>
<p>为什么要预读取:<br>DNS请求带宽很小，但一旦涉及到多级解析，或者很少访问到的网站，需要从服务器硬盘中查找域名时，这时延迟就会比较高。这点在手机网络上特别明显。因此预读取可以使得解析提早完成，减少延迟。</p>
<p>打开和关闭DNS预读取：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"x-dns-prefetch-control"</span> <span class="attr">content</span>=<span class="string">"off"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>强制查询特定主机名：<br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"http://www.spreadfirefox.com/"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"dns-prefetch"</span> <span class="attr">href</span>=<span class="string">"//www.spreadfirefox.com"</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="3-CSS属性position有几种值"><a href="#3-CSS属性position有几种值" class="headerlink" title="3. CSS属性position有几种值"></a>3. CSS属性position有几种值</h3><p>absolute   fixed   relative   static   inherit</p>
<h3 id="4-如何用正则将ejs风格分隔符-lt-gt-变成mustache风格的-123-123-125-125"><a href="#4-如何用正则将ejs风格分隔符-lt-gt-变成mustache风格的-123-123-125-125" class="headerlink" title="4. 如何用正则将ejs风格分隔符&lt;%= %&gt;变成mustache风格的&#123;&#123;&#125;&#125;"></a>4. 如何用正则将ejs风格分隔符<code>&lt;%= %&gt;</code>变成mustache风格的&#123;&#123;&#125;&#125;</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> text = <span class="string">`&lt;%=hello world%&gt;&lt;%=hello world%&gt;&lt;%=hello world%&gt;`</span></div><div class="line"><span class="keyword">var</span> result = text.replace(<span class="regexp">/&lt;%=/g</span>, <span class="string">`&#123;&#123;`</span>).replace(<span class="regexp">/%&gt;/g</span>, <span class="string">`&#125;&#125;`</span>)</div></pre></td></tr></table></figure>
<h3 id="5-在HTTP响应Header中，Cache-control的常规值有哪些？"><a href="#5-在HTTP响应Header中，Cache-control的常规值有哪些？" class="headerlink" title="5. 在HTTP响应Header中，Cache-control的常规值有哪些？"></a>5. 在HTTP响应Header中，Cache-control的常规值有哪些？</h3><p>参考网页：<a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control</a></p>
<p>Cache-control通用消息头被用于在请求和响应中通过指定指令来实现缓存机制。单向。</p>
<p>缓存请求指令：<br>Cache-Control: max-age=<code>&lt;seconds&gt;</code><br>Cache-Control: max-stale[=<code>&lt;seconds&gt;</code>] 表明客户端愿意接收一个已经过期的资源<br>Cache-Control: min-fresh=<code>&lt;seconds&gt;</code>示客户端希望在指定的时间内获取最新的响应<br>Cache-control: no-cache  强制所有缓存了该响应的缓存用户，在使用已存储的缓存数据前，发送带验证器的请求到原始服务器<br>Cache-control: no-store 缓存不应存储有关客户端请求或服务器响应的任何内容。<br>Cache-control: no-transform 不得对资源进行转换或转变。<br>Cache-control: only-if-cached 客户端只接受已缓存的响应， 并且不要向原始服务器检查是否有更新的拷贝</p>
<p>缓存响应指令：<br>Cache-control: must-revalidate 缓存必须在使用之前验证旧资源的状态，并且不可使用过期资源。<br>Cache-control: no-cache  强制所有缓存了该响应的缓存用户，在使用已存储的缓存数据前，发送带验证器的请求到原始服务器<br>Cache-control: no-store 缓存不应存储有关客户端请求或服务器响应的任何内容。<br>Cache-control: no-transform 不得对资源进行转换或转变。<br>Cache-control: public 响应可以被任何对象缓存<br>Cache-control: private 响应只能被单个用户缓存，不能作为共享缓存<br>Cache-control: proxy-revalidate 与must-revalidate作用相同，但它仅适用于共享缓存<br>Cache-Control: max-age=<seconds> 设置缓存存储的最大周期<br>Cache-control: s-maxage=<seconds> 覆盖max-age 或者 Expires 头，但是仅适用于共享缓存</seconds></seconds></p>
<p>expires: http响应首部，用来指明一个响应的到期时间。格式<code>Expires: Wed, 21 Oct 2015 07:28:00 GMT</code></p>
<h3 id="6-lt-script-gt-标签defer和async属性的作用，以及二者的区别？"><a href="#6-lt-script-gt-标签defer和async属性的作用，以及二者的区别？" class="headerlink" title="6. &lt;script&gt;标签defer和async属性的作用，以及二者的区别？"></a>6. <code>&lt;script&gt;</code>标签defer和async属性的作用，以及二者的区别？</h3><p>若没有defer和async，浏览器遇到<code>&lt;script&gt;</code>标签会立即加载并执行该脚本，且停止加载和渲染文档元素。有了defer和async时，浏览器就可以异步加载脚本，不影响文档的加载和渲染。但defer和async有一定区别，在于async会使得脚本加载完则立即执行，而defer会延迟到页面元素解析完毕后再执行。<br><img src="/2017/11/06/interview-jrtt/defer_async.jpg" alt="图片来源(https://segmentfault.com/q/1010000000640869)" title="图片来源(https://segmentfault.com/q/1010000000640869)"></p>
<h3 id="7-如何准确判断JS中一个变量的类型，请说明方法和原理。"><a href="#7-如何准确判断JS中一个变量的类型，请说明方法和原理。" class="headerlink" title="7.如何准确判断JS中一个变量的类型，请说明方法和原理。"></a>7.如何准确判断JS中一个变量的类型，请说明方法和原理。</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 方法一：typeof + instanceof</span></div><div class="line"><span class="comment">// 基本数据类型中typeof null返回object，复杂数据类型中typeof function返回function</span></div><div class="line"><span class="keyword">var</span> checkType = <span class="function"><span class="keyword">function</span>(<span class="params">vari</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result = <span class="keyword">typeof</span> vari</div><div class="line">    <span class="keyword">if</span> (<span class="built_in">Array</span>.isArray(vari)) &#123;</div><div class="line">        result = <span class="string">'array'</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">Object</span>.is(vari,<span class="literal">null</span>)) &#123;</div><div class="line">        result = <span class="string">'null'</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vari <span class="keyword">instanceof</span> <span class="built_in">Date</span>) &#123;</div><div class="line">        result = <span class="string">'date'</span></div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span> (vari <span class="keyword">instanceof</span> <span class="built_in">RegExp</span>) &#123;</div><div class="line">        result = <span class="string">'RegExp'</span></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> result</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="comment">// 方法二：大招！ </span></div><div class="line"><span class="comment">// Object原型对象的方法toString()会返回[object type]</span></div><div class="line"><span class="keyword">var</span> result = <span class="built_in">Object</span>.prototype.toString.call(vari).split(<span class="number">8</span>,<span class="number">-1</span>);</div></pre></td></tr></table></figure>
<h3 id="8-请写出下面代码的执行结果，并在注释中表名原因"><a href="#8-请写出下面代码的执行结果，并在注释中表名原因" class="headerlink" title="8.请写出下面代码的执行结果，并在注释中表名原因"></a>8.请写出下面代码的执行结果，并在注释中表名原因</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;alert(<span class="number">1</span>)&#125;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> getName;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getName</span>(<span class="params"></span>) </span>&#123;alert(<span class="number">5</span>)&#125;</div><div class="line">Foo.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;alert(<span class="number">2</span>)&#125;</div><div class="line">Foo.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;alert(<span class="number">3</span>)&#125;</div><div class="line">getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;alert(<span class="number">4</span>)&#125;</div><div class="line">getName()  <span class="comment">// 4</span></div></pre></td></tr></table></figure>
<h3 id="9-使用CSS3设计一个立起的圆形，并围绕自身中轴线做360度持续旋转（类似用手拨动一枚立起的硬币，在桌面上旋转的效果）。"><a href="#9-使用CSS3设计一个立起的圆形，并围绕自身中轴线做360度持续旋转（类似用手拨动一枚立起的硬币，在桌面上旋转的效果）。" class="headerlink" title="9.使用CSS3设计一个立起的圆形，并围绕自身中轴线做360度持续旋转（类似用手拨动一枚立起的硬币，在桌面上旋转的效果）。"></a>9.使用CSS3设计一个立起的圆形，并围绕自身中轴线做360度持续旋转（类似用手拨动一枚立起的硬币，在桌面上旋转的效果）。</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="selector-class">.circle</span> &#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">height</span>: <span class="number">100px</span>;</div><div class="line">    <span class="attribute">background-color</span>: <span class="number">#f37cae</span>;</div><div class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ee4e91</span>;</div><div class="line">    <span class="attribute">border-radius</span>: <span class="number">100%</span>;</div><div class="line">    <span class="attribute">animation</span>: rotate <span class="number">1s</span> linear infinite;</div><div class="line">&#125;</div><div class="line">@<span class="keyword">keyframes</span> rotate &#123;</div><div class="line">    0% &#123; <span class="attribute">width</span>: <span class="number">100px</span>; &#125;</div><div class="line">    25% &#123; <span class="attribute">width</span>: <span class="number">51px</span>; &#125;</div><div class="line">    50% &#123; <span class="attribute">width</span>: <span class="number">2px</span>; &#125;</div><div class="line">    75% &#123; <span class="attribute">width</span>: <span class="number">51px</span>; &#125;</div><div class="line">    100% &#123; <span class="attribute">width</span>: <span class="number">100px</span>; &#125;</div><div class="line">&#125;</div><div class="line"><span class="selector-class">.center</span> &#123;</div><div class="line">    <span class="attribute">margin</span>: <span class="number">10px</span> auto;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"circle center"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="10-编写javascript对象的深度克隆函数deepClone-注意对象值中的多种数据类型-。"><a href="#10-编写javascript对象的深度克隆函数deepClone-注意对象值中的多种数据类型-。" class="headerlink" title="10. 编写javascript对象的深度克隆函数deepClone(注意对象值中的多种数据类型)。"></a>10. 编写javascript对象的深度克隆函数deepClone(注意对象值中的多种数据类型)。</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> deepClone = <span class="function"><span class="keyword">function</span>(<span class="params">obj</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> normal = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(obj));</div><div class="line">    <span class="keyword">for</span>(key <span class="keyword">in</span> obj) &#123;</div><div class="line">        <span class="keyword">var</span> tp = <span class="built_in">Object</span>.prototype.toString.call(obj[key]).slice(<span class="number">8</span>,<span class="number">-1</span>).toLowerCase()</div><div class="line">        <span class="keyword">if</span> (tp === <span class="string">"undefined"</span>) &#123;</div><div class="line">            normal[key] = <span class="literal">undefined</span></div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tp === <span class="string">"function"</span>) &#123;</div><div class="line">            normal[key] = obj[key]</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tp === <span class="string">"date"</span>) &#123;</div><div class="line">            normal[key] = <span class="keyword">new</span> <span class="built_in">Date</span>(obj[key])</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tp === <span class="string">"RegExp"</span>) &#123;</div><div class="line">            normal[key] = <span class="keyword">new</span> <span class="built_in">RegExp</span>(obj[key])</div><div class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (tp === <span class="string">"object"</span>) &#123;</div><div class="line">            normal[key] = deepClone(obj[key])</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> normal</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="11-给定一个无序数组，请设计一个算法找出其中连续出现的数字区间。"><a href="#11-给定一个无序数组，请设计一个算法找出其中连续出现的数字区间。" class="headerlink" title="11. 给定一个无序数组，请设计一个算法找出其中连续出现的数字区间。"></a>11. 给定一个无序数组，请设计一个算法找出其中连续出现的数字区间。</h3><h3 id="12-用CSS写一个三角形"><a href="#12-用CSS写一个三角形" class="headerlink" title="12. 用CSS写一个三角形"></a>12. 用CSS写一个三角形</h3><figure class="highlight css"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/*四个三角形，若想设置单个，则其他颜色设置成transparent*/</span></div><div class="line"><span class="selector-class">.triangle</span> &#123;</div><div class="line">    <span class="attribute">width</span>: <span class="number">0</span>;</div><div class="line">    <span class="attribute">border-left</span>: <span class="number">50px</span> solid red;</div><div class="line">    <span class="attribute">border-right</span>: <span class="number">50px</span> solid yellow;</div><div class="line">    <span class="attribute">border-top</span>: <span class="number">50px</span> solid green;</div><div class="line">    <span class="attribute">border-bottom</span>: <span class="number">50px</span> solid blue;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<img src="/2017/11/06/interview-jrtt/triangle.PNG" alt="triangle.PNG" title="">

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/11/03/js-pro-delegation/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/11/03/js-pro-delegation/" itemprop="url">
                  事件委托的好处
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-11-02T21:21:22Z">
                2017-11-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>当我们需要给许多DOM添加同一个类型的事件处理程序时，逐个添加事件处理程序就会有两个问题：每个事件处理函数都是对象，而对象会占用内存，因此会小号性能；二是多个DOM引用会延迟页面交互的就绪时间，降低用户体验。<br>这时可以考虑事件委托，事件委托的原理是通过给高层元素添加一个事件处理程序，利用事件的冒泡性质捕获一系列的事件，通过判断event.target来选择性的进行处理。这样就可以实现给许多DOM元素添加一类的事件处理程序。在减少了DOM引用的同时，还减少了事件处理的函数。此外，如果我们把事件添加到document节点上，那么只要页面元素可见就可以进行交互操作，而无需等待页面加载完毕。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/09/sublime-preview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/09/sublime-preview/" itemprop="url">
                  OmniMarkupPreviewer预览md文件404问题
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T15:04:21Z">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="Question："><a href="#Question：" class="headerlink" title="Question："></a>Question：</h2><img src="/2017/10/09/sublime-preview/a.PNG" alt="a.PNG" title="">
<h2 id="Solution："><a href="#Solution：" class="headerlink" title="Solution："></a>Solution：</h2><p>On the Mac: subl “/Users/<username>/Library/Application Support/Sublime Text 3/Packages/OmniMarkupPreviewer/OmniMarkupLib/Renderers/libs/mdx_strikeout.py”</username></p>
<p>Replace the makeExtension() method with the following:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">def makeExtension(*args, **kwargs):</div><div class="line">    return StrikeoutExtension(*args, **kwargs)</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/10/09/sublime-package/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/10/09/sublime-package/" itemprop="url">
                  There are no packages for install
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-10-09T09:56:47Z">
                2017-10-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>问题代码：12029<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">Connection refused (errno 12029) during HTTP write phase of downloading</div></pre></td></tr></table></figure></p>
<p>VPN用不了结果百度了一上午找不着答案== 后来根据sublime的错误提示框进这个网址看了看 <a href="https://packagecontrol.io/docs/troubleshooting" target="_blank" rel="external">https://packagecontrol.io/docs/troubleshooting</a> ，按照如下步骤解决问题。</p>
<h2 id="第一步："><a href="#第一步：" class="headerlink" title="第一步："></a>第一步：</h2><pre><code>选择 View &gt; Show Console ，调出命令行
选择 Package Control 开头的语言。
开启debug模式
确定Package Control中的proxy代理（如果有）信息正确
如果你有代理并重写了安全连接，则需要添加CA证书。（preferences-Browse Packages-open User folder-Create a file named Package Control.user-ca-bundle and paste in a PEM-formatted version of the certificate）
</code></pre><h2 id="第二步："><a href="#第二步：" class="headerlink" title="第二步："></a>第二步：</h2><pre><code>* Open Internet Explorer
* Click the gear icon
* Select Internet Options
* Change to the Advanced tab
* Click the Reset Advanced Settings button
* Scroll down to the Security section of the options
* Verify that TLS 1.0, TLS 1.1 and TLS 1.2 are checked
</code></pre>
          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/09/07/hexo-ssh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/09/07/hexo-ssh/" itemprop="url">
                  如何配置多个SSH秘钥
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-09-07T14:46:12Z">
                2017-09-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>给本地电脑配多个SSH是一个比较常见的需求，但是在生成新的SSH文件时如果不注意配置，很容易踩到各种地雷。因此记录下此次的配置过程。</p>
<p>step1: 进入.ssh文件目录<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cd ~/.ssh</div></pre></td></tr></table></figure></p>
<p>step2: 查看.ssh目录下的文件，检查是否有id_rsa文件，若有则是已经存在秘钥<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ls</div></pre></td></tr></table></figure></p>
<p>step3: 注意这里生成的默认文件名为id_rsa，若第二步中已经有id_rsa,则在命令中输入新的文件夹名如<code>id_rsa_new</code>。然后一路回车（密码为空）。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-keygen -t rsa -b 4096 -C &quot;your_email@example.com&quot;</div></pre></td></tr></table></figure></p>
<p>step4: 将新生成的ssh秘钥添加到ssh-agent账户中。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ssh-add ~/.ssh/id_rsa_new</div></pre></td></tr></table></figure></p>
<p>step5: 配置.ssh目录下的config文件。用编辑器打开config文件。<br>编辑如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">Host github.com </div><div class="line">User qingywen@gmail.com</div><div class="line">Hostname ssh.github.com </div><div class="line">PreferredAuthentications publickey </div><div class="line">IdentityFile ~/.ssh/id_rsa </div><div class="line">Port 443 </div><div class="line"></div><div class="line">Host github2</div><div class="line">User 742925032@qq.com</div><div class="line">Hostname ssh.github.com </div><div class="line">PreferredAuthentications publickey </div><div class="line">IdentityFile ~/.ssh/id_rsa_gh</div><div class="line">Port 443</div></pre></td></tr></table></figure></p>
<p>注意：这里的host名称是区别你的秘钥的id，当你改变host名称后，从git提交的地址也要改变。比如第一个的提交地址是<code>git@github.com:qingywen/qingywen.github.io.git</code>，第二个提交地址是<code>git@github2:still-wait/still-wait.github.io.git</code></p>
<p>另：在此次的配置过程中，因为之前设置过全局用户名和邮箱，因此即使提交使用的是对应的邮箱地址的ssh，但远程库显示的提交源仍是全局的邮箱。即使在本地库已经设置过当前的用户名和邮箱。这一点有些绕，还没能理解。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/25/alg-beigel/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/08/25/alg-beigel/" itemprop="url">
                  贝格尔编排算法
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-25T10:19:39Z">
                2017-08-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>贝格尔编排算法可以有效的避免多队伍比赛中上一局优胜队跟轮空队比赛的不公平现象。一般用在队伍较少、比赛周期较长的情况下。</p>
<p>基本规则如下：queNum为参赛队伍数量。</p>
<ol>
<li>将所有队伍从1、2、3…开始编排。若总队伍为奇数，则增加0置于末尾。</li>
<li>按编号从中间分成两半，左半边从上到下书写，右半边从下到上书写，位于同一水平线的队伍进行比赛。如下。 <pre>
     1 - 0
     2 - 5
     3 - 4</pre></li>
<li>在偶次轮，将0或最大数置于左上角；在奇次轮，则置于右上角。</li>
<li>每轮将1从上一轮的位置移动指定间隔，若遇到0则跳过不算。<code>指定间隔 = Math.floor(queNum/2)</code>。</li>
<li>当已产生不大于queNum的奇次轮，则停止。</li>
</ol>
<p>若参赛队伍为5，即queNum = 5，举例如下：<br>    <pre><br>        第一轮    第二轮     第三轮    第四轮     第五轮<br>        1 - 0     0 - 4     2 - 0     0 - 5     3 - 0<br>        2 - 5     5 - 3     3 - 1     1 - 4     4 - 2<br>        3 - 4     1 - 2     4 - 5     2 - 3     5 - 1<br>    </pre></p>
<p>JS实现如下：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 贝格尔编排算法</span></div><div class="line"><span class="keyword">let</span> createMatches = <span class="function"><span class="keyword">function</span>(<span class="params">queNum</span>)</span>&#123;</div><div class="line">    <span class="comment">// 轮次</span></div><div class="line">    <span class="keyword">let</span> turnNum = queNum + (queNum%<span class="number">2</span> <span class="number">-1</span>); </div><div class="line"></div><div class="line">    <span class="comment">// 赛制编排表</span></div><div class="line">    <span class="keyword">let</span> matches = [];  </div><div class="line"></div><div class="line">    <span class="comment">// 初始轮</span></div><div class="line">    matches[<span class="number">0</span>] = [];</div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; queNum; i++)&#123;</div><div class="line">        matches[<span class="number">0</span>].push(i+<span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">if</span> (turnNum == queNum) &#123;</div><div class="line">        matches[<span class="number">0</span>].push(<span class="number">0</span>);</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">let</span> left = <span class="literal">false</span>;</div><div class="line"></div><div class="line">    <span class="comment">// 移动间隔</span></div><div class="line">    <span class="keyword">var</span> space = <span class="built_in">Math</span>.floor(queNum / <span class="number">2</span>);</div><div class="line"></div><div class="line">    <span class="comment">// 后继轮次首先将最大数字或0换边</span></div><div class="line">    <span class="comment">// 再将1按照间隔移动，其余数字逆时针填写</span></div><div class="line"></div><div class="line">    <span class="comment">// 产生后继轮次</span></div><div class="line">    <span class="keyword">for</span>(<span class="keyword">let</span> j = <span class="number">1</span>; j &lt; turnNum ; j ++) &#123;</div><div class="line">        matches[j] = <span class="keyword">new</span> <span class="built_in">Array</span>(turnNum + <span class="number">1</span>);</div><div class="line">        <span class="keyword">let</span> pos = matches[j<span class="number">-1</span>].indexOf(<span class="number">1</span>);</div><div class="line">        <span class="keyword">if</span> (left) &#123;</div><div class="line">            matches[j][turnNum] = matches[<span class="number">0</span>][turnNum];</div><div class="line">            <span class="keyword">if</span> (turnNum - pos &gt; space) &#123;</div><div class="line">                pos--;</div><div class="line">            &#125;</div><div class="line">        &#125;<span class="keyword">else</span> &#123;</div><div class="line">            matches[j][<span class="number">0</span>] = matches[<span class="number">0</span>][turnNum];</div><div class="line">            <span class="keyword">if</span> (turnNum - pos &gt;= space) &#123;</div><div class="line">                pos--;</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        left = !left;</div><div class="line">        pos = (pos + space + <span class="number">1</span>)%(turnNum+<span class="number">1</span>);</div><div class="line">        <span class="comment">// 是否遇到大数</span></div><div class="line">        <span class="keyword">let</span> meet = <span class="literal">false</span>;</div><div class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; turnNum; i++)&#123;</div><div class="line">            <span class="keyword">if</span> (matches[j][(pos+i)%(turnNum+<span class="number">1</span>)] === <span class="number">0</span>) &#123;</div><div class="line">                meet = <span class="literal">true</span>;</div><div class="line">            &#125;</div><div class="line">            <span class="keyword">if</span> (meet) &#123;</div><div class="line">                matches[j][(pos+i+<span class="number">1</span>)%(turnNum+<span class="number">1</span>)] = i+<span class="number">1</span>;</div><div class="line">            &#125; <span class="keyword">else</span> &#123;</div><div class="line">                matches[j][(pos+i)%(turnNum+<span class="number">1</span>)] = i+<span class="number">1</span>;</div><div class="line">            &#125;</div><div class="line"></div><div class="line">        &#125;</div><div class="line"></div><div class="line">    &#125;</div><div class="line">    <span class="keyword">return</span> matches;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/18/css-height/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/18/css-height/" itemprop="url">
                  CSS中的高度系列
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-18T11:18:07Z">
                2017-07-18
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <table>
<thead>
<tr>
<th>各类高度</th>
<th>包含选项</th>
</tr>
</thead>
<tbody>
<tr>
<td>height</td>
<td>content</td>
</tr>
<tr>
<td>clientHeight</td>
<td>content+padding</td>
</tr>
<tr>
<td>offsetHeight</td>
<td>content+padding+border+scroll</td>
</tr>
<tr>
<td>scrollHeight</td>
<td><code>(子元素高度 &lt;= content)? clientHeight:(子元素高度 + padding)</code></td>
</tr>
</tbody>
</table>
<p>注意：当我们按照如下设置：<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">div &#123;</div><div class="line">    height: 200px;</div><div class="line">    overflow-x: scroll; //始终显示滚动条</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>此时height的计算结果为183px，因为横向滚动条的高度为17px，需要减去这17px才是元素的实际高度值。</p>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/17/express-greeni/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/17/express-greeni/" itemprop="url">
                  Web应用初体验——登录登出验证系统
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-17T15:43:14Z">
                2017-07-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>本系统所用技术包括：jade模板（加强的html），bootstrap（css样式集），express（Web应用框架），js，nodejs，mysql，token验证等。</p>
<p>GitHub地址：<a href="https://github.com/qingywen/DEMO/tree/master/Greeni" target="_blank" rel="external">https://github.com/qingywen/DEMO/tree/master/Greeni</a></p>
<p>基本功能如下：</p>
<ol>
<li>初次登录该系统首页可浏览公共页面并进行注册。</li>
<li>成为注册用户后可登录个人中心，关闭浏览器仍保持一天之内可随时登陆。</li>
<li>登录后可注销，此后则只能浏览公共页面。</li>
<li>登录一天后或者注销后，若访问个人中心则自动引导到登录页面。</li>
</ol>
<h2 id="step1"><a href="#step1" class="headerlink" title="step1"></a>step1</h2><p>先写前端界面，包括index.html(公共页面)，login.html(登录页面)，signup.html(注册页面)，my.html(个人中心)，这里用到了bootstrap的示例页面signin，carousel和dashboard的页面结构和样式。</p>
<p>也许会有人跟我一样刚开始接触bootstrap并不知从何用起，以下做个简短说明：bootstrap是一个css样式集，用的好可以为你的项目锦上添花，用不好反倒累赘，因此还需好好琢磨。了解bootstrap的菜鸟教程可以浏览<a href="http://www.runoob.com/bootstrap/bootstrap-tutorial.html" target="_blank" rel="external">菜鸟教程</a>。实际上，bootstrap3的<a href="http://v3.bootcss.com/" target="_blank" rel="external">中文官网</a>已经讲解的非常详尽。不过仍建议先阅读菜鸟教程进行热身。</p>
<p>页面js主要功能为表单提交，提交前先进行简单的验证，再序列化表单，接着用ajax提交到服务器，最后关闭表单的默认提交功能。</p>
<h2 id="step2"><a href="#step2" class="headerlink" title="step2"></a>step2</h2><p>前端界面搭建好后，我们来新建一个数据库，数据库表中只有一个users表，结构如下：</p>
<table>
<thead>
<tr>
<th>Field</th>
<th>Type</th>
<th>Null</th>
<th>Key</th>
<th>Default</th>
<th>Extra</th>
</tr>
</thead>
<tbody>
<tr>
<td>P_Id</td>
<td>int(11)</td>
<td>No</td>
<td>PRI</td>
<td>NULL</td>
<td>auto_increment</td>
</tr>
<tr>
<td>email</td>
<td>varchar(255)</td>
<td>NO</td>
<td>UNI</td>
<td>NULL</td>
<td></td>
</tr>
<tr>
<td>password</td>
<td>varchar(255)</td>
<td>NO</td>
<td></td>
<td>NULL</td>
<td></td>
</tr>
</tbody>
</table>
<p>现在表数据如下：</p>
<table>
<thead>
<tr>
<th>P_Id</th>
<th>email</th>
<th>password</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>1195259521@qq.com</td>
<td>123</td>
</tr>
<tr>
<td>9</td>
<td>qingywen@gmail.com</td>
<td>123</td>
</tr>
<tr>
<td>12</td>
<td>wenwu@gmai.com</td>
<td>123</td>
</tr>
<tr>
<td>14</td>
<td>123@qq.com</td>
<td>123</td>
</tr>
</tbody>
</table>
<p>数据库导出文件为greeni.sql，在本地数据库中将sql文件导入新建数据库greeni即可。</p>
<h2 id="step3"><a href="#step3" class="headerlink" title="step3"></a>step3</h2><p>前端、数据库搭建好后，我们即可开始整个应用的系统搭建，通过后台逻辑将前端和数据库连接起来。</p>
<p>这里在一个新文件夹中用<code>express</code>进行项目初始化，当然前提是本地用npm安装了express。接着在package.json中加入db、ejs、jsonwebtoken三个模块，然后用<code>cnpm install</code>进行安装。</p>
<p>这里我们需要将app.js文件中默认的渲染引擎从jade改为ejs。<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// view engine setup</span></div><div class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>));</div><div class="line">pp.engine(<span class="string">'.html'</span>, <span class="built_in">require</span>(<span class="string">'ejs'</span>).__express);</div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'jade'</span>);</div></pre></td></tr></table></figure></p>
<p>修改routes文件夹下index.js、my.js的路由定向和事件句柄，此时要用到数据库，因此新建db文件夹，在db目录下新建DBConfig.js和SQL.js，分别用作数据库的连接配置文件和SQL语句模块。</p>
<p>在写登录验证的逻辑时，我们根据用户邮箱用jsonwebtoken随机生成一个令牌，并发送用户，用户在cookie中保存此令牌，在下次请求私有资源时则不必明文发送密码，而是在发送请求时随着cookie自动将令牌发送给服务器，服务器收到令牌验证成功后则返回用户所请求的资源，否则令牌有可能被恶意更改，则拒绝请求。</p>
<p>此时系统搭建完毕，我么可以用<code>npm start</code>来启动项目，注意bin文件夹写的端口号为8000，因此访问地址为：127.0.0.1:8000。</p>
<h2 id="step4"><a href="#step4" class="headerlink" title="step4"></a>step4</h2><p>最后我们想做一个小优化，如果每个用户登录到个人中心的页面都一样的话，这个个人中心恐怕是个假个人中心，因此我们需要对不同的用户请求返回一样的页面结构但是不同的用户信息。为求简易，这里我们只对每个用户返回各自的email，并添加到页面上。</p>
<p>因为页面首先需要在服务器上渲染才能返回给客户端，最经济的思路当然是在服务端渲染出不同的页面再返回给客户端。而html并没有变量的功能，因此我们使用jade模板（现更名为pug，但jade模块仍有效）来代替html。jade是一个非常高效的模板引擎，提供了变量、for循环等功能。有一个非常好的<a href="https://naltatis.github.io/jade-syntax-docs/" target="_blank" rel="external">jade语法学习网站</a>安利给大家。这里我们需要将之前的html转为jade，手动改编太麻烦，用这个<a href="http://www.html2jade.org/" target="_blank" rel="external">html2jade</a>的网站来转化吧。</p>
<p>得到jade格式的前端文件，我们修改app.js的模板引擎设置，将ejs引擎改回默认的jade引擎：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// view engine setup</span></div><div class="line">app.set(<span class="string">'views'</span>, path.join(__dirname, <span class="string">'views'</span>));</div><div class="line">app.set(<span class="string">'view engine'</span>, <span class="string">'jade'</span>);</div></pre></td></tr></table></figure></p>
<p>在routes下的my.js中，返回个人中心页面同时，返回用户的email：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">res.render(<span class="string">'my'</span>,&#123;<span class="attr">email</span>: decoded.email&#125;);</div></pre></td></tr></table></figure></p>
<p>修改views文件夹下my.jade文件中的标题，用来接收服务器传送来的email变量：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">a.navbar-brand(href=&apos;#&apos;) #&#123;email&#125;</div></pre></td></tr></table></figure></p>
<p>此后大功告成，每个用户登陆后访问个人中心的页面，其页面标题都是自己用来注册的email，因此此个人中心成立。</p>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><ol>
<li>表单序列化方法<code>serialize()</code>，阻止表单默认提交方式<code>preventDefault()</code>，以及设置cookie的<code>CookieUtil.set()</code>均来自《JS高级程序设计》。</li>
<li>登录后通过令牌验证来避免密码泄露用到<code>jwt.sign() jwt.verify()</code>，建议细看jsonwebtoken包下的README.md，讲解很详细。</li>
<li>README.md文件是个好东西，许多网上的经验贴都没有官方使用文档讲的简单易懂。sublime有许多markdown实时阅览插件很方便，此<a href="http://www.jianshu.com/p/335b7d1be39e" target="_blank" rel="external">博主</a>有分享。</li>
<li>源代码是最后版本，因此前文所述中间过程可能不能详尽体现，但可以按照上述方式进行此系统的构建。这篇记录不是使用说明，仅作一个Guide，有问题Google和百度并行解决。若解决不了可联系数据库中P_Id为1的邮箱，我会尽快为你回复。</li>
</ol>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/07/12/nodejs-token/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="青菜">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青菜不是葵花">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                
                <a class="post-title-link" href="/2017/07/12/nodejs-token/" itemprop="url">
                  浅谈令牌原理及漏洞分析
                </a>
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-07-11T18:59:14Z">
                2017-07-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术/" itemprop="url" rel="index">
                    <span itemprop="name">技术</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>相关资源：<br><a href="https://auth0.com/blog/critical-vulnerabilities-in-json-web-token-libraries/" target="_blank" rel="external">令牌讲解</a><br><a href="https://github.com/brianloveswords/node-jws" target="_blank" rel="external"> 使用方法</a></p>
<h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><h3 id="token"><a href="#token" class="headerlink" title="token"></a>token</h3><p>中文译名为令牌，包含三个部分：header、payload、signature。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">token = encodeBase64(header) + <span class="string">'.'</span> + encodeBase64(payload) + <span class="string">'.'</span> + encodeBase64(signature)</div></pre></td></tr></table></figure>
<h3 id="header"><a href="#header" class="headerlink" title="header"></a>header</h3><p>此为令牌的头部，可以在其中设置签名算法和token类型，如下所示：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">header = <span class="string">'&#123;"alg":"HS256","typ":"JWT"&#125;'</span></div></pre></td></tr></table></figure></p>
<h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>该部分包含我们需要设置的信息：<br><figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">payload = <span class="string">'&#123;"loggedInAs":"admin","iat":1422779638&#125;'</span></div></pre></td></tr></table></figure></p>
<h3 id="signature"><a href="#signature" class="headerlink" title="signature"></a>signature</h3><p>signature则是将header和payload结合并用指定算法进行签名（加密）的结果。</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">key = <span class="string">'secretkey'</span></div><div class="line">unsignedToken = encodeBase64(header) + <span class="string">'.'</span> + encodeBase64(payload)</div><div class="line">signature = HMAC-SHA256(key, unsignedToken)</div></pre></td></tr></table></figure>
<h1 id="令牌原理"><a href="#令牌原理" class="headerlink" title="令牌原理"></a>令牌原理</h1><p>验证令牌有效性是整个机制的关键：我们的方法是根据header里提供的信息，对payload再次进行签名，并将结果与signature进行比对，如果一致，则令牌有效；若不一致，则说明是经过恶意改动的无效令牌。</p>
<h1 id="关键漏洞"><a href="#关键漏洞" class="headerlink" title="关键漏洞"></a>关键漏洞</h1><ol>
<li>因为我们的令牌中header和payload部分可直接通过解码获得，因此我们的签名算法等信息可以被任意人员获取，且signature部分的签名算法是通过header里的信息来决定的。因此攻击者可以将令牌头部信息设置为alt: none，因此服务器可能会将未经验证的signature当做已经验证过且有效的token。这样任何人就可以随意访问我们的系统。但是，现在大多数库都对此有一个防御机制：若提供了secret key，则那些设置为alt: none的令牌就无效，故而解决。</li>
<li>令牌机制的关键漏洞在于服务端的验证算法取决于令牌里的header信息。如果令牌采用RS256算法进行签名，一旦攻击者获得public key，则可以用如下方式来伪造令牌：将令牌的算法设置为HS256，并将secret key设置为RS256算法的签名公钥，这样就可以鱼目混珠啦。如下图所示。但这种方式理论上是这样，实际上的测试结果并不如此，而是返回invalid algorithm的错误。若有大神知道还求解答。不过针对此种错误，jsonwebtoken已经给出了相应的解决方案，服务端在验证时可以指定签名算法的类型，因此可以避免伪造令牌。</li>
</ol>
<figure class="highlight js"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> fs = <span class="built_in">require</span>(<span class="string">'fs'</span>);</div><div class="line"><span class="keyword">var</span> jwt = <span class="built_in">require</span>(<span class="string">'jsonwebtoken'</span>);</div><div class="line"><span class="keyword">var</span> cert_pub = fs.readFileSync(__dirname + <span class="string">'/rsa-public-key.pem'</span>);</div><div class="line"></div><div class="line"><span class="keyword">var</span> tokenPayload = &#123;</div><div class="line">    <span class="attr">foo</span>: <span class="string">"bar"</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> forgedToken = jwt.sign(tokenPayload,  cert_pub, &#123; <span class="attr">algorithm</span>: <span class="string">'HS256'</span> &#125;);</div><div class="line"></div><div class="line">jwt.verify(forgedToken, cert_pub, <span class="function"><span class="keyword">function</span>(<span class="params">err,decoded</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="built_in">console</span>.error(err);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="built_in">console</span>.log(decoded);</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>

          
        
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <div>
      
    </div>

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </article>


    
  </section>

  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      

      <section class="site-overview sidebar-panel sidebar-panel-active">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.jpg"
               alt="青菜" />
          <p class="site-author-name" itemprop="name">青菜</p>
           
              <p class="site-description motion-element" itemprop="description">主攻前端方向，偶尔来点杂文</p>
          
        </div>
        <nav class="site-state motion-element">

          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">25</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-categories">
              <a href="/categories/index.html">
                <span class="site-state-item-count">1</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            
            
            <div class="site-state-item site-state-tags">
              <a href="/tags/index.html">
                <span class="site-state-item-count">15</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/qingywen" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
              <span class="links-of-author-item">
                <a href="https://www.zhihu.com/people/mo-si-ye-96" target="_blank" title="zhihu">
                  
                    <i class="fa fa-fw fa-globe"></i>
                  
                  zhihu
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy; 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">青菜</span>
</div>

<!-- 

<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>

 -->

 
<div>
  Patience is bitter,  but its fruit is sweet.
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  






  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  


  




	





  





  





  






  





  

  

  

  

</body>
</html>
